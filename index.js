const express = require('express')
const mongoose = require('mongoose')
const bodyParser = require('body-parser')
require('dotenv').config({path:'./variables.env'})

mongoose.connect(process.env.DATABASE)

mongoose.connection.on('error',function(error){
    console.log('error de mongoose', error)
})

require('./Schemas/Persona')
const modeloPersona=mongoose.model('Persona')

const app = express()
app.use(bodyParser())


app.get('/persona',function(req,res){
    const miPersona=new modeloPersona({
        name:req.query.name,
        username:req.query.username,
        password:req.query.password,
        age:req.query.age
    })
    miPersona.save().then(function(){
        res.send('PERSONA GUARDADA')
    })
})
app.get('/buscar-persona',function(req,res){
    console.log(req.query.username)
    const search={
        username:req.query.username
    }
    modeloPersona.find(search).then(function(users){
        res.send(users)
    })
})


app.get('/',function(req,res){res.send('Hola')})
app.listen(prosess.env.PORT,function(){console.log('funcionando en el puerto 1001')})
